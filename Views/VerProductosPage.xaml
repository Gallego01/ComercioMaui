<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ComercioMaui.Views.VerProductosPage"
             Title="Inventario de Productos">

    <VerticalStackLayout Spacing="15" Padding="20">

        <Label Text="Inventario Detallado" 
               FontSize="Large" 
               FontAttributes="Bold" 
               HorizontalOptions="Center" />
        <Picker x:Name="CategoriaPicker"
                Title="Seleccione una Categoría"
                ItemDisplayBinding="{Binding Nombre}"  
                SelectedIndexChanged="OnCategoriaFilterChanged" />
        <BoxView HeightRequest="1" Color="LightGray" Margin="0,10,0,10"/>

        <ScrollView>
            <VerticalStackLayout>

                <Grid Padding="10" BackgroundColor="#E0E0E0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1*" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>

                    <Label Grid.Column="0" Text="Producto" FontAttributes="Bold" FontSize="Small" HorizontalOptions="Center"/>
                    <Label Grid.Column="1" Text="Precio" FontAttributes="Bold" FontSize="Small" HorizontalOptions="Center"/>
                    <Label Grid.Column="2" Text="Stock" FontAttributes="Bold" FontSize="Small" HorizontalOptions="Center"/>
                    <Label Grid.Column="3" Text="Mínimo" FontAttributes="Bold" FontSize="Small" HorizontalOptions="Center"/>
                </Grid>

                <CollectionView x:Name="ProductosCollection" 
                                SelectionMode="Single"  RemainingItemsThreshold="1"
                                ItemsUpdatingScrollMode="KeepItemsInView">

                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid Padding="10" ColumnSpacing="5" Margin="0, 0, 0, 5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="1*" />
                                    <ColumnDefinition Width="1*" />
                                </Grid.ColumnDefinitions>

                                <VerticalStackLayout Grid.Column="0">
                                    <Label Text="{Binding Nombre}" FontAttributes="Bold" FontSize="Micro" HorizontalOptions="Center"/>
                                </VerticalStackLayout>

                                <Label Grid.Column="1" Text="{Binding Precio, StringFormat='{0:C}'}" TextColor="Green" FontSize="Micro" HorizontalOptions="Center" VerticalOptions="Center"/>
                                <Label Grid.Column="2" Text="{Binding Stock}" FontSize="Micro" HorizontalOptions="Center" VerticalOptions="Center"/>
                                <Label Grid.Column="3" Text="{Binding StockMinimo}" FontSize="Micro" HorizontalOptions="Center" VerticalOptions="Center"/>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </ScrollView>
        <HorizontalStackLayout x:Name="ProductosButtonsLayout" Spacing="10" HorizontalOptions="Center">
            <Button Text="Agregar Producto" Clicked="OnAgregarProductoClicked" />
            <Button Text="Editar Producto" Clicked="OnEditarProductoClicked" />
            <Button Text="Eliminar Producto" Clicked="OnEliminarProductoClicked" BackgroundColor="Red" TextColor="White"/>
        </HorizontalStackLayout>
    </VerticalStackLayout>
</ContentPage>